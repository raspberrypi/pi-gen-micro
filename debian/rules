#!/usr/bin/make -f

export DH_VIRTUALENV_INSTALL_ROOT=/opt/venvs
PACKAGE=$(shell dh_listpackages)
DH_VENV_DIR=debian/$(PACKAGE)$(DH_VIRTUALENV_INSTALL_ROOT)/$(PACKAGE)

%:
	dh $@ --with python-virtualenv

# Manually remove pip and allow system pacakges as the following does not work:
# export DH_VIRTUALENV_ARGUMENTS="--system-site-packages --without-pip"
override_dh_virtualenv:
	dh_virtualenv --python python3
	$(DH_VENV_DIR)/bin/python -m pip uninstall --yes pip
	sed --in-place '/^include-system-site-packages/s/false/true/' $(DH_VENV_DIR)/pyvenv.cfg
